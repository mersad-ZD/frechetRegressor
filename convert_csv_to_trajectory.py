# -*- coding: utf-8 -*-
"""convert_csv_to_trajectory.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1ofNDD_HaJALXznQEhyRsfKmpBX3eE-yy
"""

from google.colab import drive
drive.mount('/content/drive')

import numpy as np
import pandas as pd
import glob
# from test_padding import trajectory_padding


vectore1 = np.zeros((128, 2), dtype=np.float32)
vectore2 = np.zeros((128, 2), dtype=np.float32)

my_data = np.zeros((100000, 513), dtype=np.float32)

def trajectory_padding(lst):
    # maxList = max(lst, key=lambda i: len(i))
    # maxLength = len(maxList)
    maxLength = 128

    temp_lst = []
    if len(lst) < maxLength:
        nesbat = int(maxLength / len(lst))
        remain = maxLength % len(lst)
        for item in lst:
            temp_lst.extend([item] * nesbat)
        if (remain != 0):
            temp_lst.extend([lst[-1]] * remain)


    return temp_lst



my_data = []
# df = pd.read_csv(r"/content/drive/My Drive/Tdrive_csv/T drive seprate backup/2008-02-03/ID-10357-2008-02-03.csv")
path = r'/content/drive/My Drive/Tdrive_csv/T drive seprate backup/2008-02-07'
all_files = glob.glob(path + "/*.csv")

for files in all_files:
  long_vec = []
  lat_vec = []
  new_lat_vec = []
  new_long_vec = []
  lat_long_vec = []

  df = pd.read_csv(files)

  if not df.empty:
      id = df["taxi_id"][0]

      # lat_long_vec.append(id)


      for i in range(len(df["latitude"])):
            lat = df["latitude"][i]
            lat_vec.append(lat)


            if len(lat_vec) >= 128:
                  break

      for i in range(len(df["longitude"])):
            long = df["longitude"][i]
            long_vec.append(long)


            if len(long_vec) >= 128:
                  break


      if len(lat_vec) < 128:
          new_lat_vec = trajectory_padding(lat_vec)
      else:
            new_lat_vec = lat_vec.copy()



      if len(long_vec) < 128:
           new_long_vec = trajectory_padding(long_vec)
      else:
            new_long_vec = long_vec.copy()

      lat_long_vec = new_lat_vec + new_long_vec

      my_data.append(lat_long_vec)
      print("length is ", len(lat_long_vec))

dataset = pd.DataFrame(data=my_data)
print("shape:", dataset.shape)

dataset.to_csv(r"/content/drive/My Drive/Tdrive_trajectory/tdrive_2008-02-07__lat_long.csv" , index=False )